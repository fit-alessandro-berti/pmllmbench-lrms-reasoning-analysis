[
  {
    "Name": "Pattern Recognition - IND",
    "Text": "Consider an event log stored in a DuckDB table named event_log with columns case_id activity timestamp A process variant is defined as the ordered sequence of activities that occur in a single case determined by sorting events within that case by their timestamp"
  },
  {
    "Name": "Hypothesis Generation - PE",
    "Text": "One approach using list_agg ordered to create the sequence for each case SELECT case_id list_agg(activity ORDER BY timestamp) as activity_sequence FROM event_log GROUP BY case_id"
  },
  {
    "Name": "Deductive Reasoning - PE",
    "Text": "Then group by that sequence to get variant counts SELECT activity_sequence count as case_count FROM case_sequences GROUP BY activity_sequence ORDER BY case_count DESC LIMIT K"
  },
  {
    "Name": "Hypothesis Generation - PE",
    "Text": "Now we have top K sequences Then join back to original event_log to get all events for those case_ids SELECT e FROM event_log e JOIN top_cases ON e.case_id = top_cases.case_id"
  },
  {
    "Name": "Heuristic Reasoning - PE",
    "Text": "Alternatively use a CTE to make it readable"
  },
  {
    "Name": "Inductive Reasoning - IND",
    "Text": "We can also use array_agg(activity ORDER BY timestamp) as activity_sequence Then group For K maybe use a constant or parameter We can set K 5 for example"
  },
  {
    "Name": "Validation - PE",
    "Text": "WITH case_sequences AS SELECT case_id list_agg(activity ORDER BY timestamp) AS activity_sequence FROM event_log GROUP BY case_id variant_counts AS SELECT activity_sequence count AS case_count FROM case_sequences GROUP BY activity_sequence ORDER BY case_count DESC LIMIT 3 top_cases AS SELECT cs.case_id FROM case_sequences cs JOIN variant_counts vc ON cs.activity_sequence = vc.activity_sequence SELECT e FROM event_log e JOIN top_cases tc ON e.case_id = tc.case_id ORDER BY e.case_id e.timestamp"
  },
  {
    "Name": "Backtracking - IND",
    "Text": "Alternatively we can use string_agg(activity ORDER BY timestamp) as activity_sequence if you want to limit K as a parameter you can set a variable like SET K 5 then use K However we can keep it simple just a constant"
  },
  {
    "Name": "Counterfactual Reasoning - NE",
    "Text": "We may want to include the variant and its count in the final result That would be helpful But requirement Return all events from the original event log that belong only to cases which are part of these top K variants doesnt require to include variant information"
  },
  {
    "Name": "Conclusion - C"
  }
]